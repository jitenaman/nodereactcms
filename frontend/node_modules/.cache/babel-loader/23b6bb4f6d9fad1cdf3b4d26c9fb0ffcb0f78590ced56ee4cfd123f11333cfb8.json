{"ast":null,"code":"import{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import API from\"../api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ManagePosts(){const[posts,setPosts]=useState([]);const[page,setPage]=useState(1);const[pages,setPages]=useState(1);const[loading,setLoading]=useState(true);const fetchPosts=async function(){let pageNum=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;setLoading(true);try{const res=await API.get(\"/posts?page=\".concat(pageNum,\"&limit=5\"));setPosts(res.data.posts||[]);setPages(res.data.pages||1);setPage(res.data.page||1);}catch(err){var _err$response;console.error(\"Failed to fetch posts:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setPosts([]);}finally{setLoading(false);}};useEffect(()=>{fetchPosts(1);},[]);const handleDelete=async id=>{if(!window.confirm(\"Are you sure you want to delete this post?\"))return;try{await API.delete(\"/posts/\".concat(id));fetchPosts(page);}catch(err){var _err$response2;console.error(\"Delete failed:\",((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||err.message);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"20px\"},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[\"Manage Posts\",/*#__PURE__*/_jsx(Link,{to:\"/create\",style:{marginLeft:\"auto\",padding:\"6px 12px\",background:\"#4CAF50\",color:\"#fff\",textDecoration:\"none\",borderRadius:\"4px\"},children:\"Create Post\"})]}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading posts...\"}):/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"10\",style:{width:\"100%\",borderCollapse:\"collapse\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Content\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Image\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:posts.length>0?posts.map(p=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:p.title}),/*#__PURE__*/_jsxs(\"td\",{children:[p.content.substring(0,50),\"...\"]}),/*#__PURE__*/_jsx(\"td\",{children:p.image&&/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5000/uploads/\".concat(p.image),alt:\"\",width:\"80\"})}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/edit/\".concat(p._id),style:{marginRight:\"10px\"},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(p._id),children:\"Delete\"})]})]},p._id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"4\",children:\"No posts found\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"20px\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchPosts(page-1),disabled:page===1,children:\"\\u2B05 Prev\"}),Array.from({length:pages},(_,i)=>i+1).map(num=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchPosts(num),style:{margin:\"0 5px\",background:num===page?\"#1e1e2f\":\"#ddd\",color:num===page?\"#fff\":\"#000\"},children:num},num)),/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchPosts(page+1),disabled:page===pages,children:\"Next \\u27A1\"})]})]});}","map":{"version":3,"names":["useEffect","useState","Link","API","jsx","_jsx","jsxs","_jsxs","ManagePosts","posts","setPosts","page","setPage","pages","setPages","loading","setLoading","fetchPosts","pageNum","arguments","length","undefined","res","get","concat","data","err","_err$response","console","error","response","message","handleDelete","id","window","confirm","delete","_err$response2","style","padding","children","display","justifyContent","alignItems","to","marginLeft","background","color","textDecoration","borderRadius","border","cellPadding","width","borderCollapse","map","p","title","content","substring","image","src","alt","_id","marginRight","onClick","colSpan","marginTop","disabled","Array","from","_","i","num","margin"],"sources":["C:/xampp/htdocs/cms-project/frontend/src/pages/ManagePosts.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport API from \"../api\";\n\nexport default function ManagePosts() {\n  const [posts, setPosts] = useState([]);\n  const [page, setPage] = useState(1);\n  const [pages, setPages] = useState(1);\n  const [loading, setLoading] = useState(true);\n\n  const fetchPosts = async (pageNum = 1) => {\n    setLoading(true);\n    try {\n      const res = await API.get(`/posts?page=${pageNum}&limit=5`);\n      setPosts(res.data.posts || []);\n      setPages(res.data.pages || 1);\n      setPage(res.data.page || 1);\n    } catch (err) {\n      console.error(\"Failed to fetch posts:\", err.response?.data || err.message);\n      setPosts([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPosts(1);\n  }, []);\n\n  const handleDelete = async (id) => {\n    if (!window.confirm(\"Are you sure you want to delete this post?\")) return;\n    try {\n      await API.delete(`/posts/${id}`);\n      fetchPosts(page);\n    } catch (err) {\n      console.error(\"Delete failed:\", err.response?.data || err.message);\n    }\n  };\n\n  return (\n    <div style={{ padding: \"20px\" }}>\n      <h2 style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n      Manage Posts\n      <Link to=\"/create\" style={{ marginLeft: \"auto\", padding: \"6px 12px\", background: \"#4CAF50\", color: \"#fff\", textDecoration: \"none\", borderRadius: \"4px\" }}>\n        Create Post\n      </Link>\n    </h2>\n      \n      {loading ? (\n        <p>Loading posts...</p>\n      ) : (\n        <table border=\"1\" cellPadding=\"10\" style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th>Title</th>\n              <th>Content</th>\n              <th>Image</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {posts.length > 0 ? (\n              posts.map((p) => (\n                <tr key={p._id}>\n                  <td>{p.title}</td>\n                  <td>{p.content.substring(0, 50)}...</td>\n                  <td>\n                    {p.image && (\n                      <img\n                        src={`http://localhost:5000/uploads/${p.image}`}\n                        alt=\"\"\n                        width=\"80\"\n                      />\n                    )}\n                  </td>\n                  <td>\n                    <Link to={`/edit/${p._id}`} style={{ marginRight: \"10px\" }}>\n                      Edit\n                    </Link>\n                    <button onClick={() => handleDelete(p._id)}>Delete</button>\n                  </td>\n                </tr>\n              ))\n            ) : (\n              <tr>\n                <td colSpan=\"4\">No posts found</td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      )}\n\n      {/* Pagination */}\n      <div style={{ marginTop: \"20px\" }}>\n        <button onClick={() => fetchPosts(page - 1)} disabled={page === 1}>\n          ⬅ Prev\n        </button>\n        {Array.from({ length: pages }, (_, i) => i + 1).map((num) => (\n          <button\n            key={num}\n            onClick={() => fetchPosts(num)}\n            style={{\n              margin: \"0 5px\",\n              background: num === page ? \"#1e1e2f\" : \"#ddd\",\n              color: num === page ? \"#fff\" : \"#000\",\n            }}\n          >\n            {num}\n          </button>\n        ))}\n        <button onClick={() => fetchPosts(page + 1)} disabled={page === pages}>\n          Next ➡\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}