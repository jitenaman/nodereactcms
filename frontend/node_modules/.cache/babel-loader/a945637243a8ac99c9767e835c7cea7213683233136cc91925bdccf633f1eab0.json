{"ast":null,"code":"import{useEffect,useState}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import{Link}from\"react-router-dom\";import API from\"../api\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function EditPost(){const{id}=useParams();const navigate=useNavigate();const[title,setTitle]=useState(\"\");const[content,setContent]=useState(\"\");const[image,setImage]=useState(null);// new file\nconst[preview,setPreview]=useState(\"\");// URL for preview\nconst[loading,setLoading]=useState(true);useEffect(()=>{const fetchPost=async()=>{try{const res=await API.get(\"/posts/\".concat(id));setTitle(res.data.title||\"\");setContent(res.data.content||\"\");// set preview to existing image if available\nif(res.data.image){setPreview(\"http://localhost:5000/uploads/\".concat(res.data.image));}setLoading(false);}catch(err){var _err$response;console.error(\"Failed to fetch post:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setLoading(false);}};fetchPost();},[id]);// Handle image file selection\nconst handleImageChange=e=>{const file=e.target.files[0];setImage(file);if(file){const reader=new FileReader();reader.onloadend=()=>setPreview(reader.result);reader.readAsDataURL(file);// show preview\n}};const handleUpdate=async e=>{e.preventDefault();try{const formData=new FormData();formData.append(\"title\",title);formData.append(\"content\",content);if(image)formData.append(\"image\",image);await API.put(\"/posts/\".concat(id),formData,{headers:{\"Content-Type\":\"multipart/form-data\"}});navigate(\"/manage\");// redirect after update\n}catch(err){var _err$response2;console.error(\"Update failed:\",((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||err.message);}};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading post...\"});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[\"Edit Posts\",/*#__PURE__*/_jsx(Link,{to:\"/manage\",style:{marginLeft:\"auto\",padding:\"6px 12px\",background:\"#4CAF50\",color:\"#fff\",textDecoration:\"none\",borderRadius:\"4px\"},children:\"Back\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdate,style:{maxWidth:\"500px\",margin:\"40px auto\",padding:\"20px\",border:\"1px solid #ccc\",borderRadius:\"8px\",background:\"#f9f9f9\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,onChange:e=>setTitle(e.target.value),placeholder:\"Title\",required:true,style:{width:\"100%\",marginBottom:\"10px\",padding:\"8px\"}}),/*#__PURE__*/_jsx(\"textarea\",{value:content,onChange:e=>setContent(e.target.value),placeholder:\"Content\",required:true,rows:5,style:{width:\"100%\",marginBottom:\"10px\",padding:\"8px\"}}),preview&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:\"10px\"},children:/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"Preview\",style:{width:\"150px\",height:\"auto\"}})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleImageChange,style:{marginBottom:\"10px\"}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{padding:\"8px 16px\"},children:\"Update Post\"})]})]});}","map":{"version":3,"names":["useEffect","useState","useParams","useNavigate","Link","API","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EditPost","id","navigate","title","setTitle","content","setContent","image","setImage","preview","setPreview","loading","setLoading","fetchPost","res","get","concat","data","err","_err$response","console","error","response","message","handleImageChange","e","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","handleUpdate","preventDefault","formData","FormData","append","put","headers","_err$response2","children","style","display","justifyContent","alignItems","to","marginLeft","padding","background","color","textDecoration","borderRadius","onSubmit","maxWidth","margin","border","type","value","onChange","placeholder","required","width","marginBottom","rows","src","alt","height"],"sources":["C:/xampp/htdocs/cms-project/frontend/src/pages/EditPost.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { Link } from \"react-router-dom\";\nimport API from \"../api\";\n\nexport default function EditPost() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState(null); // new file\n  const [preview, setPreview] = useState(\"\"); // URL for preview\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchPost = async () => {\n      try {\n        const res = await API.get(`/posts/${id}`);\n        setTitle(res.data.title || \"\");\n        setContent(res.data.content || \"\");\n\n        // set preview to existing image if available\n        if (res.data.image) {\n          setPreview(`http://localhost:5000/uploads/${res.data.image}`);\n        }\n\n        setLoading(false);\n      } catch (err) {\n        console.error(\"Failed to fetch post:\", err.response?.data || err.message);\n        setLoading(false);\n      }\n    };\n    fetchPost();\n  }, [id]);\n\n  // Handle image file selection\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n    setImage(file);\n\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => setPreview(reader.result);\n      reader.readAsDataURL(file); // show preview\n    }\n  };\n\n  const handleUpdate = async (e) => {\n    e.preventDefault();\n    try {\n      const formData = new FormData();\n      formData.append(\"title\", title);\n      formData.append(\"content\", content);\n      if (image) formData.append(\"image\", image);\n\n      await API.put(`/posts/${id}`, formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n\n      navigate(\"/manage\"); // redirect after update\n    } catch (err) {\n      console.error(\"Update failed:\", err.response?.data || err.message);\n    }\n  };\n\n  if (loading) return <p>Loading post...</p>;\n\n  return (\n    <>\n    <h2 style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n      Edit Posts\n      <Link to=\"/manage\" style={{ marginLeft: \"auto\", padding: \"6px 12px\", background: \"#4CAF50\", color: \"#fff\", textDecoration: \"none\", borderRadius: \"4px\" }}>\n        Back\n      </Link>\n    </h2>\n    <form onSubmit={handleUpdate} style={{\n        maxWidth: \"500px\",\n        margin: \"40px auto\",\n        padding: \"20px\",\n        border: \"1px solid #ccc\",\n        borderRadius: \"8px\",\n        background: \"#f9f9f9\",\n      }}>\n       \n\n      <input\n        type=\"text\"\n        value={title}\n        onChange={(e) => setTitle(e.target.value)}\n        placeholder=\"Title\"\n        required\n        style={{ width: \"100%\", marginBottom: \"10px\", padding: \"8px\" }}\n      />\n\n      <textarea\n        value={content}\n        onChange={(e) => setContent(e.target.value)}\n        placeholder=\"Content\"\n        required\n        rows={5}\n        style={{ width: \"100%\", marginBottom: \"10px\", padding: \"8px\" }}\n      ></textarea>\n\n      {/* Image preview */}\n      {preview && (\n        <div style={{ marginBottom: \"10px\" }}>\n          <img src={preview} alt=\"Preview\" style={{ width: \"150px\", height: \"auto\" }} />\n        </div>\n      )}\n\n      <input\n        type=\"file\"\n        onChange={handleImageChange}\n        style={{ marginBottom: \"10px\" }}\n      />\n\n      <button type=\"submit\" style={{ padding: \"8px 16px\" }}>\n        Update Post\n      </button>\n    </form>\n   </> \n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}